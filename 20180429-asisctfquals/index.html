<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        ASIS CTF Quals 2018 - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/styles/github-gist.min.css" integrity="sha256-tAflq+ymku3Khs+I/WcAneIlafYgDiOQ9stIHH985Wo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400italic,600,600italic,300italic,300|Source+Serif+Pro|Source+Code+Pro:400,300,500&subset=latin,latin-ext);.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\A0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.markdown-body kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,sans-serif;padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:758px;margin-top:25px;margin-bottom:-25px;color:#777}.ui-toc{position:fixed;bottom:20px;z-index:10000}.ui-toc-label{opacity:.3;background-color:#ccc;border:none;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,Hiragino Kaku Gothic Pro,\\30D2\30E9\30AE\30CE\89D2\30B4 Pro W3,Osaka,Meiryo,\\30E1\30A4\30EA\30AA,MS Gothic,"\FF2D\FF33   \30B4\30B7\30C3\30AF",sans-serif}.ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,"\FF2D\FF33   \FF30\30B4\30B7\30C3\30AF",sans-serif}.markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang TC,Microsoft JhengHei,\\5FAE\8EDF\6B63\9ED1,sans-serif}.ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,\\5FAE\8EDF\6B63\9ED1UI,sans-serif}.markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang SC,Microsoft YaHei,\\5FAE\8F6F\96C5\9ED1,sans-serif}.ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,\\5FAE\8F6F\96C5\9ED1UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:contain}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.unselectable{-moz-user-select:none;-webkit-user-select:none;-o-user-select:none;user-select:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid"><h1 id="ASIS-CTF-Quals-2018" style=""><a class="anchor hidden-xs" href="#ASIS-CTF-Quals-2018" title="ASIS-CTF-Quals-2018"><span class="octicon octicon-link"></span></a>ASIS CTF Quals 2018</h1><p><s>This write-up is already published on <a href="https://github.com/balsn/ctf_writeup/" target="_blank">GitHub</a>. Instead of updating the writeup here, please send a pull request to GitHub.</s></p><p></p><div class="toc"><ul><li><a href="#ASIS-CTF-Quals-2018" title="ASIS CTF Quals 2018">ASIS CTF Quals 2018</a><ul><li><a href="#Web" title="Web">Web</a><ul><li><a href="#Nice-code-unsolved-written-by-bookgin" title="Nice code (unsolved, written by bookgin)">Nice code (unsolved, written by bookgin)</a></li><li><a href="#Bug-Flag-bookgin-sces60107" title="Bug Flag (bookgin, sces60107)">Bug Flag (bookgin, sces60107)</a></li><li><a href="#Good-WAF-solved-by-ysc-written-by-bookgin" title="Good WAF (solved by ysc, written by bookgin)">Good WAF (solved by ysc, written by bookgin)</a></li><li><a href="#Personal-Website-solved-by-sasdf-bookgin-sces60107-written-by-bookgin" title="Personal Website (solved by sasdf, bookgin, sces60107, written by bookgin)">Personal Website (solved by sasdf, bookgin, sces60107, written by bookgin)</a></li><li><a href="#Sharp-eyes-unsolved-written-by-bookgin-special-thanks-to-herrera" title="Sharp eyes (unsolved, written by bookgin, special thanks to @herrera)">Sharp eyes (unsolved, written by bookgin, special thanks to @herrera)</a></li><li><a href="#Gameshop-unsolved" title="Gameshop (unsolved)">Gameshop (unsolved)</a></li></ul></li><li><a href="#rev" title="rev">rev</a><ul><li><a href="#Warm-up-sces60107" title="Warm up (sces60107)">Warm up (sces60107)</a></li><li><a href="#baby-C-sces60107" title="baby C (sces60107)">baby C (sces60107)</a></li><li><a href="#Echo-sces60107" title="Echo (sces60107)">Echo (sces60107)</a></li><li><a href="#Left-or-Right-sces60107" title="Left or Right? (sces60107)">Left or Right? (sces60107)</a></li><li><a href="#Density-sces60107" title="Density (sces60107)">Density (sces60107)</a></li></ul></li><li><a href="#pwn" title="pwn">pwn</a></li><li><a href="#PPC" title="PPC">PPC</a><ul><li><a href="#Neighbour-lwc" title="Neighbour (lwc)">Neighbour (lwc)</a></li><li><a href="#The-most-Boring-how2hack" title="The most Boring (how2hack)">The most Boring (how2hack)</a></li><li><a href="#Shapiro-shw" title="Shapiro (shw)">Shapiro (shw)</a></li></ul></li><li><a href="#misc" title="misc">misc</a><ul><li><a href="#Plastic-sces60107" title="Plastic (sces60107)">Plastic (sces60107)</a></li></ul></li><li><a href="#forensic" title="forensic">forensic</a><ul><li><a href="#Trashy-Or-Classy-sces60107-bookgin" title="Trashy Or Classy (sces60107 bookgin)">Trashy Or Classy (sces60107 bookgin)</a></li><li><a href="#Tokyo-sces60107" title="Tokyo (sces60107)">Tokyo (sces60107)</a></li></ul></li><li><a href="#crypto" title="crypto">crypto</a><ul><li><a href="#the_early_school-shw" title="the_early_school (shw)">the_early_school (shw)</a></li><li><a href="#Iran-shw-and-sasdf" title="Iran (shw and sasdf)">Iran (shw and sasdf)</a></li></ul></li></ul></li></ul></div><p></p><h2 id="Web" style=""><a class="anchor hidden-xs" href="#Web" title="Web"><span class="octicon octicon-link"></span></a>Web</h2><h3 id="Nice-code-unsolved-written-by-bookgin" style=""><a class="anchor hidden-xs" href="#Nice-code-unsolved-written-by-bookgin" title="Nice-code-unsolved-written-by-bookgin"><span class="octicon octicon-link"></span></a>Nice code (unsolved, written by bookgin)</h3><p>The challenge is related to PHP code review.</p><p>The page will show the error message. All we have to do is bypass the error :)</p><pre><code># substr($URL, -10) !== '/index.php'
http://167.99.36.112:8080/admin/index.php
# $URL == '/admin/index.php'
http://167.99.36.112:8080/admin/index.php/index.php
</code></pre><p>Next, we are redirected to <a href="http://167.99.36.112:8080/another/index.php?source" target="_blank">http://167.99.36.112:8080/another/index.php?source</a> .</p><pre><code class="php hljs"> <span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">include</span>(<span class="hljs-string">'oshit.php'</span>);
$g_s = [<span class="hljs-string">'admin'</span>,<span class="hljs-string">'oloco'</span>];
$__ni = $_POST[<span class="hljs-string">'b'</span>];
$_p = <span class="hljs-number">1</span>;
<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'source'</span>])){
    highlight_file(<span class="hljs-keyword">__FILE__</span>);
        <span class="hljs-keyword">exit</span>;
}
<span class="hljs-keyword">if</span>($__ni === $g_s &amp; $__ni[<span class="hljs-number">0</span>] != <span class="hljs-string">'admin'</span>){
    $__dgi = $_GET[<span class="hljs-string">'x'</span>];
    $__dfi = $_GET;
    <span class="hljs-keyword">foreach</span>($__dfi <span class="hljs-keyword">as</span> $_k_o =&gt; $_v){
        <span class="hljs-keyword">if</span>($_k_o == $k_Jk){
            $f = <span class="hljs-number">1</span>;
        }
        <span class="hljs-keyword">if</span>($f &amp;&amp; strlen($__dgi)&gt;<span class="hljs-number">17</span> &amp;&amp; $_p == <span class="hljs-number">3</span>){
            $k_Jk($_v,$_k_o); <span class="hljs-comment">//my shell :)</span>
        }
        $_p++;
    }
}<span class="hljs-keyword">else</span>{    
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"noob!"</span>;
}

</code></pre><p>Also note that the server uses PHP/5.5.9-1ubuntu4.14. Then I got stuck here for DAYS. After a few tries, I think it’s impossible to bypass <code>===</code>.</p><p>However, that’s not the case in PHP 5.5.9 due to <a href="https://bugs.php.net/bug.php?id=69892" target="_blank">this bug</a>. Just send a big index, and it will be casted to int. Overflow!</p><p>The rest is simple. No need to guess the content in <code>oshit.php</code>. Use system to RCE.</p><p>Postscript:</p><ol>
<li>The bug seems to be famous(infamous) in 2015,2016 PHP CTFs. You can Google the link or bug id and you’ll find lots of challenges related to this bug.</li>
<li>Always pay attention to the version server used. The current release is PHP 7.2, but the challenge uses PHP 5.5.9.</li>
<li>If the condition is impossible to bypass, just dig into the bug databse/source code.</li>
<li>The challenge is solved by more than 20 teams, so it must be simple to find a solution.</li>
</ol><p>I’ve learned a lot. Thanks to this challenge and PHP!</p><h3 id="Bug-Flag-bookgin-sces60107" style=""><a class="anchor hidden-xs" href="#Bug-Flag-bookgin-sces60107" title="Bug-Flag-bookgin-sces60107"><span class="octicon octicon-link"></span></a>Bug Flag (bookgin, sces60107)</h3><p>Get source code by LFI <code>http://46.101.173.61/image?name=app.py</code>. It’s Python2 + Flask.</p><pre><code class="python hljs"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, Response, render_template, session, request, jsonify

app = Flask(__name__)
app.secret_key = open(<span class="hljs-string">'private/secret.txt'</span>).read()

flags = {
	<span class="hljs-string">'fake1'</span>: {
		<span class="hljs-string">'price'</span>: <span class="hljs-number">125</span>,
		<span class="hljs-string">'coupons'</span>: [<span class="hljs-string">'fL@__g'</span>],
		<span class="hljs-string">'data'</span>: <span class="hljs-string">'fake1{this_is_a_fake_flag}'</span>
	},
	<span class="hljs-string">'fake2'</span>: {
		<span class="hljs-string">'price'</span>: <span class="hljs-number">290</span>,
		<span class="hljs-string">'coupons'</span>: [<span class="hljs-string">'fL@__g'</span>],
		<span class="hljs-string">'data'</span>: <span class="hljs-string">'fake2{this_is_a_fake_flag}'</span>
	},
	<span class="hljs-string">'asis'</span>: {
		<span class="hljs-string">'price'</span>: <span class="hljs-number">110</span>,
		<span class="hljs-string">'coupons'</span>: [],
		<span class="hljs-string">'data'</span>: open(<span class="hljs-string">'private/flag.txt'</span>).read()
	}
}

<span class="hljs-meta">@app.route('/')</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>
	<span class="hljs-keyword">if</span> session.get(<span class="hljs-string">'credit'</span>) == <span class="hljs-keyword">None</span>:
		session[<span class="hljs-string">'credit'</span>] = <span class="hljs-number">0</span>
		session[<span class="hljs-string">'coupons'</span>] = []
	<span class="hljs-keyword">return</span> render_template(<span class="hljs-string">'index.html'</span>, credit = session[<span class="hljs-string">'credit'</span>])
	<span class="hljs-comment">#return 'Hello World!&lt;br&gt;Your Credit is {}&lt;br&gt;Used Coupons is {}'.format(session.get('credit'), session.get('coupons'))</span>

<span class="hljs-meta">@app.route('/image')</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">resouce</span><span class="hljs-params">()</span>:</span>
	image_name = request.args.get(<span class="hljs-string">'name'</span>)
	<span class="hljs-keyword">if</span> <span class="hljs-string">'/'</span> <span class="hljs-keyword">in</span> image_name <span class="hljs-keyword">or</span> <span class="hljs-string">'..'</span> <span class="hljs-keyword">in</span> image_name <span class="hljs-keyword">or</span> <span class="hljs-string">'private'</span> <span class="hljs-keyword">in</span> image_name:
		<span class="hljs-keyword">return</span> <span class="hljs-string">'Access Denied'</span>
	<span class="hljs-keyword">return</span> Response(open(image_name).read(), mimetype=<span class="hljs-string">'image/png'</span>)

<span class="hljs-meta">@app.route('/pay', methods=['POST'])</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pay</span><span class="hljs-params">()</span>:</span>
	data = request.get_json()
	card = data[<span class="hljs-string">'card'</span>]
	coupon = data[<span class="hljs-string">'coupon'</span>]
	<span class="hljs-keyword">if</span> coupon.replace(<span class="hljs-string">'='</span>,<span class="hljs-string">''</span>) <span class="hljs-keyword">in</span> session.get(<span class="hljs-string">'coupons'</span>):
		<span class="hljs-keyword">return</span> jsonify({<span class="hljs-string">'result'</span>: <span class="hljs-string">'the coupon is already used'</span>})
	<span class="hljs-keyword">for</span> flag <span class="hljs-keyword">in</span> card:
		<span class="hljs-keyword">if</span> flag[<span class="hljs-string">'count'</span>] &lt;= <span class="hljs-number">0</span>:
			<span class="hljs-keyword">return</span> jsonify({<span class="hljs-string">'result'</span>:<span class="hljs-string">'item count must be greater than zero'</span>})
	discount = <span class="hljs-number">0</span>
	<span class="hljs-keyword">for</span> flag <span class="hljs-keyword">in</span> card:
                <span class="hljs-keyword">if</span> coupon.decode(<span class="hljs-string">'base64'</span>).strip() <span class="hljs-keyword">in</span> flags[flag[<span class="hljs-string">'name'</span>]][<span class="hljs-string">'coupons'</span>]:
			discount += flag[<span class="hljs-string">'count'</span>] * flags[flag[<span class="hljs-string">'name'</span>]][<span class="hljs-string">'price'</span>]
	credit = session.get(<span class="hljs-string">'credit'</span>) + discount
	<span class="hljs-keyword">for</span> flag <span class="hljs-keyword">in</span> card:
		credit -= flag[<span class="hljs-string">'count'</span>] * flags[flag[<span class="hljs-string">'name'</span>]][<span class="hljs-string">'price'</span>]
	<span class="hljs-keyword">if</span> credit &lt; <span class="hljs-number">0</span>:
		result = {<span class="hljs-string">'result'</span>: <span class="hljs-string">'your credit not enough'</span>}
	<span class="hljs-keyword">else</span>:
		result = {<span class="hljs-string">'result'</span>: <span class="hljs-string">'pay success'</span>}
		result_data = []
		<span class="hljs-keyword">for</span> flag <span class="hljs-keyword">in</span> card:
			result_data.append({<span class="hljs-string">'flag'</span>: flag[<span class="hljs-string">'name'</span>], <span class="hljs-string">'data'</span>: flags[flag[<span class="hljs-string">'name'</span>]][<span class="hljs-string">'data'</span>]})
		result[<span class="hljs-string">'data'</span>] = result_data
		session[<span class="hljs-string">'credit'</span>] = credit
		session[<span class="hljs-string">'coupons'</span>].append(coupon.replace(<span class="hljs-string">'='</span>,<span class="hljs-string">''</span>))
	<span class="hljs-keyword">return</span> jsonify(result)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
	app.run(host=<span class="hljs-string">'0.0.0.0'</span>, port=<span class="hljs-number">80</span>)
</code></pre><p>The first thought comes to my mind is race condition. We can send 2 requests to manipulate the session variables. However, manipulating credit leads to nothing, because it’s not dependent on executing orders. Manipulating coupons is useless, neither. Why bother using a coupon twice? Just create another session.</p><p>Then I start to dig if there is any logical error. The objective is to make the credit &gt;= 0 when buying the real flag. After some brainstroming, I try to buy 0.01 fake flags, and it works.</p><p>Let’s test Python floating-point precision.</p><pre><code class="python hljs">Python <span class="hljs-number">2.7</span><span class="hljs-number">.14</span> (default, Jan  <span class="hljs-number">5</span> <span class="hljs-number">2018</span>, <span class="hljs-number">10</span>:<span class="hljs-number">41</span>:<span class="hljs-number">29</span>) 
[GCC <span class="hljs-number">7.2</span><span class="hljs-number">.1</span> <span class="hljs-number">20171224</span>] on linux2
Type <span class="hljs-string">"help"</span>, <span class="hljs-string">"copyright"</span>, <span class="hljs-string">"credits"</span> <span class="hljs-keyword">or</span> <span class="hljs-string">"license"</span> <span class="hljs-keyword">for</span> more information.
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-number">1.335</span> * <span class="hljs-number">125</span> + <span class="hljs-number">0.334</span> * <span class="hljs-number">290</span> - <span class="hljs-number">1.335</span> * <span class="hljs-number">125</span> - <span class="hljs-number">0.334</span> * <span class="hljs-number">290</span>
<span class="hljs-number">1.4210854715202004e-14</span>
</code></pre><p>Isn’t it cool and surprising? Note that <code>1.4210854715202004e-14</code> is a positive number. For the count of real flag, we can buy <code>0.0000000...1</code>.</p><p>Payload:</p><pre><code>{"card":[{"name":"fake1","count":1.335},{"name":"fake2","count":0.334},{"name":"asis","count":0.0000000000000000000000000001}],"coupon":"ZkxAX19n"}
</code></pre><p>Flag: <code>ASIS{th1@n_3xpens1ve_Fl@G}</code></p><p>You can abuse Python <code>NaN</code> to solve this challenge as well. Refer to <a href="https://ctftime.org/writeup/9893" target="_blank">this writeup</a>.</p><h3 id="Good-WAF-solved-by-ysc-written-by-bookgin" style=""><a class="anchor hidden-xs" href="#Good-WAF-solved-by-ysc-written-by-bookgin" title="Good-WAF-solved-by-ysc-written-by-bookgin"><span class="octicon octicon-link"></span></a>Good WAF (solved by ysc, written by bookgin)</h3><p>The challenge requires us to bypass the WAF on SQL injection.</p><p><strong>Unintended solution:</strong></p><p>When the organizer is fixing the challenge by editing the source code, @ysc’s web scanner found <code>.index.php.swp</code>, and we got the source code. The flag is there. That’s all.</p><p>Flag: <code>ASIS{e279aaf1780c798e55477a7afc7b2b18}</code></p><p>Never fix anything on the production server directly :)</p><h3 id="Personal-Website-solved-by-sasdf-bookgin-sces60107-written-by-bookgin" style=""><a class="anchor hidden-xs" href="#Personal-Website-solved-by-sasdf-bookgin-sces60107-written-by-bookgin" title="Personal-Website-solved-by-sasdf-bookgin-sces60107-written-by-bookgin"><span class="octicon octicon-link"></span></a>Personal Website (solved by sasdf, bookgin, sces60107, written by bookgin)</h3><p>Firstly dive into <code>http://206.189.54.119:5000/site.js</code>. There are 4 interesting pages:</p><ul>
<li>admin_area</li>
<li>get/title/1</li>
<li>get/text/1</li>
<li>get/image/1</li>
</ul><p>The <code>admin_area</code> requires an authorization_token in the header, and the page will check the token. If it’s incorrect, an error occurs <code>Authorization Failed.</code></p><p>Let’s fuzz the three <code>get</code> APIs. The title, text seem not injectable and only parse integer until encountering an invalid character. However, image is injectable. The <code>get/image/0+1</code> is equal to <code>get/image/1</code>. Even <code>get/image/eval("0+1")</code> works like a charm. So we got a blind injection here. The backend is Nodejs + express. I’ll first guess it’s using mongoDB.</p><p>Keey moving on. We try to extract the information of the backend, only to find it’s in nodejs vm2. There is no <code>require</code> so we cannot RCE. Actually versatile @sasdf spent some time on trying to escape the vm, but it seems very hard.</p><p>Next, we leaked <code>module</code> and find <code>_mongo</code>, <code>db</code>. It’s possible to get all collection names via <code>db.collection.getname()</code>. Then, use eval and <code>this["db"].credentials.find().toArray()</code> to dump the database. We dump <code>credentials</code> and <code>authorization</code>:</p><pre><code>{"_id":{"str":"5ae63ae0a86f623c83fecfb3"},"id":1,"method":"post_data","format":"username=[username]&amp;password=[password]","activate":"false"}
{"_id":{"str":"5ae63ae0a86f623c83fecfb4"},"id":2,"method":"header","format":"md5(se3cr3t|[username]|[password])","activate":"true"}

{"_id":{"str":"5ae63ae0a86f623c83fecfb1"},"id":1,"username":"administrator","password":"H4rdP@ssw0rd?"}
</code></pre><p>Great! The payload:</p><pre><code class="sh hljs"><span class="hljs-attribute">curl</span> <span class="hljs-string">'http://206.189.54.119:5000/admin_area'</span> -H <span class="hljs-string">"authorization_token:`echo -n 'se3cr3t|administrator|H4rdP<span class="hljs-variable">@ssw0rd</span>?' | md5sum | cut 
-f1 -d' '`"</span>
</code></pre><p>Flag: <code>ASIS{3c266f6ccdaaef52eb4a9ab3abc2ca70}</code></p><p>Postscript: Take a look at Yashar Shahinzadeh’s <a href="https://medium.com/bugbountywriteup/mongodb-injection-asisctf-2018-quals-personal-website-write-up-web-task-115be1344ea2" target="_blank">writeup</a>. In fact, the server will send back the error message through the response header <code>Application-Error</code>. There is no need to perform blind injection. We are reckless and didn’t find this.</p><p>Next time, I’ll carefully inspect every payload and HTTP status code/headers.</p><h3 id="Sharp-eyes-unsolved-written-by-bookgin-special-thanks-to-herrera" style=""><a class="anchor hidden-xs" href="#Sharp-eyes-unsolved-written-by-bookgin-special-thanks-to-herrera" title="Sharp-eyes-unsolved-written-by-bookgin-special-thanks-to-herrera"><span class="octicon octicon-link"></span></a>Sharp eyes (unsolved, written by bookgin, special thanks to @herrera)</h3><p>The incorrect account/password in the login page will redirect to <code>error/1</code>. Missing either account or password parameter redirects to <code>error/2</code>.</p><p>The source HTML of <code>error/1</code>.</p><pre><code class="html hljs"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">'/jquery-3.3.1.min.js'</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">'style.css'</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">'stylesheet'</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"accordion"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">dl</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dt</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"active"</span>&gt;</span>
    	
<span class="hljs-comment">&lt;!-- Filtered output to prevent XSS --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-keyword">var</span> user = <span class="hljs-string">'1'</span>;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>Invalid credentials were given.
</code></pre><p>If the URL is  <code>error/hello</code>, the js part becomes <code>var user = 'hello';</code>. Addtionally, some characters <code>&lt;&gt;",</code> are filtered, but it’s imple to bypass using single quotes and semicolons.</p><p>It’s obvious that we have to somehow make the admin trigger this XSS, but how? I guess the admin will read the log in the server, but after a few tries, we found it does’t work at all. Ok, so why does variable user mean in the javascript here? Maybe we can inject the XSS payload to the username login page. but it doesn’t work, neither.</p><p>What if it’s not a XSS challenge? I don’t think so because:</p><ol>
<li>I note that the jQuery is loaded in the error page, but it’s not used.</li>
<li>There is a XSS filter.</li>
</ol><p>The discovery strongly indicates this is a XSS challenge. However, why does the error code is assigned to a user variable? This does not make sense at all.</p><p>This challenge made me very frustrated.  I think the XSS part is very misleading at the begninning, though it’s used after logged in successfully.</p><p>It was not unitl the last 30 minutes that we found the error code is vulnerable to SQL injection. The server returns the content but the status code is 500. Thanks to @sasdf 's sharp eyes. I’m too careless to find the SQL injection vulenerability.</p><p>SQLmap will dump the database. The DB is SQlite.</p><p>Thanks to @herrera in IRC channel:</p><blockquote>
<p>sharp eyes was sqli on /error/1, getting username/hash of the user david, logging into him, then using /error/1 as a XSS too, sending it to admin and getting the flag on flag.php</p>
</blockquote><p>Postscript:</p><ol>
<li>Sharp eyes: HTTP status code</li>
<li>Some misleading part might be the second stage of the challenge.</li>
<li>It a number of teams solve this challenge, it must be not difficult.</li>
</ol><h3 id="Gameshop-unsolved" style=""><a class="anchor hidden-xs" href="#Gameshop-unsolved" title="Gameshop-unsolved"><span class="octicon octicon-link"></span></a>Gameshop (unsolved)</h3><p>Please refer to <a href="https://blog.harold.kim/2018/04/asisctf-2018-gameshop-solution" target="_blank">official solution</a>.</p><p>Acctually, we spent a few hours on MicroDB LFI. Next, I’m trying to find a way to exploit all the possible <code>die(__FLAG__)</code>. I know we may use unserialization to create <code>Affimojas-&gt;flag = 0</code>, since in PHP, <code>var_dump(0 == "asdasdasd"); // bool(true)</code> .</p><p>However, I cannot find the way to exploit unserilization. In the last 1 hours, @sasdf noted that we can manipulate the first block, but we though we didn’t have much time solving this challenge.</p><p>There is a long road to go on solving web challnges:)</p><h2 id="rev" style=""><a class="anchor hidden-xs" href="#rev" title="rev"><span class="octicon octicon-link"></span></a>rev</h2><h3 id="Warm-up-sces60107" style=""><a class="anchor hidden-xs" href="#Warm-up-sces60107" title="Warm-up-sces60107"><span class="octicon octicon-link"></span></a>Warm up (sces60107)</h3><p>This is a warm up challenge. They give you a C file like this.</p><pre><code class="C hljs"><span class="hljs-comment">#define M 37</span>
<span class="hljs-comment">#define	q (2+M/M)</span>
<span class="hljs-comment">#define	v (q/q)</span>
<span class="hljs-comment">#define	ef ((v+q)/2)</span>
<span class="hljs-comment">#define	f (q-v-ef)</span>
<span class="hljs-comment">#define k (8-ef)</span>
struct b{int64_t <span class="hljs-keyword">y</span>[<span class="hljs-number">13</span>];}S;<span class="hljs-keyword">int</span> <span class="hljs-keyword">m</span>=<span class="hljs-number">1811939329</span>,N=<span class="hljs-number">1</span>,t[<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">26</span>]=<span class="hljs-string">{2}</span>,a,*p,i,e=<span class="hljs-number">73421233</span>,<span class="hljs-keyword">s</span>,c,U=<span class="hljs-number">1</span>;g(d,h){<span class="hljs-keyword">for</span>(i=<span class="hljs-keyword">s</span>;i&lt;<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">25</span>;i*=<span class="hljs-number">2</span>)d=d*<span class="hljs-number">1</span>LL*d%m;<span class="hljs-keyword">for</span>(p=t;p&lt;t+N;p+=<span class="hljs-keyword">s</span>)<span class="hljs-keyword">for</span>(i=<span class="hljs-keyword">s</span>,c=<span class="hljs-number">1</span>;i;i--)a=p[<span class="hljs-keyword">s</span>]*(h?c:<span class="hljs-number">1</span>LL)%m,p[<span class="hljs-keyword">s</span>]=(<span class="hljs-keyword">m</span>*<span class="hljs-number">1</span>U+*p-a)*(h?<span class="hljs-number">1</span>LL:c)%m,*p=(a*<span class="hljs-number">1</span>U+*p)%m,p++,c=c*<span class="hljs-number">1</span>LL*d%m;}l(){<span class="hljs-keyword">while</span>(e/=<span class="hljs-number">2</span>){N*=<span class="hljs-number">2</span>;U=U*<span class="hljs-number">1</span>LL*(<span class="hljs-keyword">m</span>+<span class="hljs-number">1</span>)/<span class="hljs-number">2</span>%m;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">s</span>=N;<span class="hljs-regexp">s/=2;)g(136,0);for(p=t;p&lt;t+N;p++)*p=*p*1LL**p%m*U%m;for(s=1;s&lt;N;s*=2)g(839354248,1);for(a=0,p=t;p&lt;t+N;)a+=*p&lt;&lt;(e&amp;1),*p++=a%10,a/=10;}}z(n){int y=3,j,c;for(j=2;j&lt;=n;){l();for(c=2;c&lt;=y-1;c++){l();if(y%c==0)break;}if(c==y){l();j++;}y++;}l();return y-1;}main(a, pq) char* pq;{int b=sizeof(S),y=b,j=M;l();int x[M]={b-M-sizeof((short int) a),(b&gt;&gt;v)+(k&lt;&lt;v)+ (v&lt;&lt;(q|ef)) + z(v+(ef&lt;&lt;v)),(z(k*ef)&lt;&lt;v)-pow(ef,f), z(( (j-ef*k)|(ef&lt;&lt;k&gt;&gt;v)/k</span>-ef&lt;&lt;v)-ef),(((<span class="hljs-keyword">y</span>+M)&amp;b)&lt;&lt;(k/<span class="hljs-keyword">q</span>+ef))-z(ef+v),((ef&lt;&lt;k)-v)&amp;<span class="hljs-keyword">y</span>,<span class="hljs-keyword">y</span>*v+v,(ef&lt;&lt;(<span class="hljs-keyword">q</span>*ef-v-(k&gt;&gt;ef)))*<span class="hljs-keyword">q</span>-v,(f&lt;&lt;<span class="hljs-keyword">q</span>)|(ef&lt;&lt;(<span class="hljs-keyword">q</span>*f+k))-j+k,(z(z(z(z(z(v)))))*<span class="hljs-keyword">q</span>)&amp;(((j/<span class="hljs-keyword">q</span>)-(ef&lt;&lt;v))&lt;&lt;<span class="hljs-keyword">q</span>)|(j+(<span class="hljs-string">q|(ef&lt;&lt;v))),y|</span>(<span class="hljs-keyword">q</span>+v),(ef&lt;&lt;ef)-v+ef*(((j&gt;&gt;ef)|j)-v+ef-<span class="hljs-keyword">q</span>+v),(z(j&amp;(b&lt;&lt;ef))&amp;(z(v&lt;&lt;v)&lt;&lt;k))-(<span class="hljs-string">q&lt;&lt;v)-q,(k&lt;&lt;q)+q,(z(y)&gt;</span>&gt;(ef&lt;&lt;v))+(z(k+v))-<span class="hljs-keyword">q</span>,(z(z(k&amp;ef|j))&amp;b|ef|v&lt;&lt;f&lt;&lt;<span class="hljs-string">q&lt;&lt;v&amp;ef&gt;</span>&gt;k|<span class="hljs-string">q&lt;&lt;ef&lt;&lt;v|k|q)+z(v&lt;&lt;v)+v,(ef&gt;</span>&gt;v)*<span class="hljs-keyword">q</span>*z(k-v)+z(ef&lt;&lt;ef&amp;<span class="hljs-string">q|k)+ef,z(k&lt;&lt;k)&amp;v&amp;k|</span><span class="hljs-keyword">y</span>+k-v,z(f&gt;&gt;ef|k&gt;&gt;ef|v|k)*(ef&gt;&gt;v)*<span class="hljs-keyword">q</span>,(ef&lt;&lt;k-ef&lt;&lt;v&gt;&gt;<span class="hljs-string">q&lt;&lt;ef*ef)-j+(ef&lt;&lt;v),z(ef*k)*z(v&lt;&lt;v)+k-v,z((z(k)&lt;&lt;z(v)))&amp;y|k|v,z(ef&lt;&lt;ef&lt;&lt;v&lt;&lt;v)/ef+z(v&lt;&lt;ef|k|(b&gt;</span>&gt;<span class="hljs-keyword">q</span>)&amp;<span class="hljs-keyword">y</span>-f)-(ef&lt;&lt;<span class="hljs-keyword">q</span>)+(k-v)-ef,k&lt;&lt;(ef+<span class="hljs-keyword">q</span>)/z(ef)*z(<span class="hljs-keyword">q</span>)&amp;z(k&lt;&lt;k)|v,((z(<span class="hljs-keyword">y</span>|j&gt;&gt;k*ef))%ef&lt;&lt;z(v&lt;&lt;v&lt;&lt;v)&gt;&gt;<span class="hljs-string">q&lt;&lt;q|j)/ef+v,(j-ef&lt;&lt;ef&lt;&lt;v*z(v&gt;</span>&gt;v&lt;&lt;v)&gt;&gt;ef)/ef%z(k&lt;&lt;j)+<span class="hljs-keyword">q</span>,z(k-v)+k|z(ef&lt;&lt;k&gt;&gt;v&lt;&lt;f)-z(<span class="hljs-string">q&lt;&lt;q)*ef&gt;</span>&gt;v,(z(ef|<span class="hljs-keyword">y</span>&amp;j|k)%q|j+ef&lt;&lt;z(k|ef)%k&lt;&lt;<span class="hljs-string">q|ef|</span>k&lt;&lt;ef&lt;&lt;<span class="hljs-keyword">q</span>/ef|<span class="hljs-keyword">y</span>/ef+j&gt;&gt;<span class="hljs-keyword">q</span>)&amp;k&lt;&lt;j|ef+v,<span class="hljs-number">84</span>,z(v*ef&lt;&lt;ef&lt;&lt;<span class="hljs-keyword">q</span>)*<span class="hljs-keyword">q</span>%ef&lt;&lt;k|k|<span class="hljs-keyword">q</span>-v,((z(<span class="hljs-number">20</span>)*v)|(f&gt;&gt;<span class="hljs-keyword">q</span>)|(k&lt;&lt;k))/ef-(ef&lt;&lt;(v*<span class="hljs-keyword">q</span>+ef))-(k&lt;&lt;<span class="hljs-keyword">q</span>)+z(k)-<span class="hljs-keyword">q</span>};<span class="hljs-keyword">while</span>(j--){putchar(<span class="hljs-keyword">x</span>[M-v-j]);}<span class="hljs-keyword">printf</span>(<span class="hljs-string">" From ASIS With Love &lt;3\n"</span>);<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}
</code></pre><p>You can compile the code. But when executing the binary, it just hanging there. So the first step is to understand this code.<br>
It look likes you need to beautify this code. You can count on online tools, but I do this with myself.</p><p>And I found out there is a useless function <code>l</code> which seems to waste lots of time. I just deleted that function in the code and compile the code again. Eventualy, I got the flag and the first blood.</p><p>The flag is <code>ASIS{hi_all_w31c0m3_to_ASISCTF}</code></p><h3 id="baby-C-sces60107" style=""><a class="anchor hidden-xs" href="#baby-C-sces60107" title="baby-C-sces60107"><span class="octicon octicon-link"></span></a>baby C (sces60107)</h3><p>This challenge give you a obfuscated binary.</p><p>It is obvious that they use <a href="https://github.com/xoreaxeaxeax/movfuscator" target="_blank">movfuscator</a>.</p><p>It’s not easy to reverse such obfuscated binary directly. You will need the help of <code>qira</code> or <code>gdb</code>. And I choose the former.</p><p>But it’s still difficult to trace the program flow. After a while, I notice that there is <code>strncmp</code> in this binary.</p><pre><code>...
.text:08049557                 mov     eax, off_83F6170[edx*4]
.text:0804955E                 mov     edx, dword_81F6110
.text:08049564                 mov     [eax], edx
.text:08049566                 mov     esp, off_83F6130
.text:0804956C                 mov     dword_85F61C4, offset strncmp_plt
.text:08049576                 mov     eax, dword_83F6158
.text:0804957B                 mov     eax, off_85F61C8[eax*4]
.text:08049582                 mov     eax, [eax]
...
</code></pre><p>I utilized <code>qira</code> to trace the program and realized that part of code is doing <code>strncmp(input[3:],"m0vfu3c4t0r!",0xc)</code></p><p>Well, the hint tell us <code>flag is ASIS{sha1(input[:14])}</code></p><p>Now we just need the first three byte.</p><p>The next step needs patience. you have to trace down the code manually.</p><p>Then you can find this</p><pre><code>...
.text:080498C8                 mov     dl, byte ptr dword_804D050
.text:080498CE                 mov     edx, dword_81F5B70[edx*4]
.text:080498D5                 mov     dword_804D05C, edx
.text:080498DB                 mov     dword_804D058, 'A'
.text:080498E5                 mov     eax, dword_804D05C
.text:080498EA                 mov     edx, dword_804D058
.text:080498F0                 mov     ecx, 8804B21Ch
...
</code></pre><p>If you are familiar with movfuscator, you will know this part of code is trying to compare two bytes. I knew this because I read this <a href="https://github.com/xoreaxeaxeax/movfuscator/blob/master/slides/domas_2015_the_movfuscator.pdf" target="_blank">pdf</a> in order to solve this challenge.</p><p>Now we know it is try to compare the first byte of input to <code>A</code></p><p>The rest of this chanllenge is diggin out the other code which try to compare the second and the third byte.</p><pre><code>...
.text:08049BED                 mov     edx, 0
.text:08049BF2                 mov     dl, byte ptr dword_804D050
.text:08049BF8                 mov     edx, dword_81F5B70[edx*4]
.text:08049BFF                 mov     dword_804D05C, edx
.text:08049C05                 mov     dword_804D058, 'h'
.text:08049C0F                 mov     eax, dword_804D05C
.text:08049C14                 mov     edx, dword_804D058
.text:08049C1A                 mov     ecx, 8804B21Ch
...
.text:08049F17                 mov     edx, 0
.text:08049F1C                 mov     dl, byte ptr dword_804D050
.text:08049F22                 mov     edx, dword_81F5B70[edx*4]
.text:08049F29                 mov     dword_804D05C, edx
.text:08049F2F                 mov     dword_804D058, '_'
.text:08049F39                 mov     eax, dword_804D05C
.text:08049F3E                 mov     edx, dword_804D058
.text:08049F44                 mov     ecx, 8804B21Ch
...
</code></pre><p>Finally, we got <code>input[:14]</code> which is <code>Ah_m0vfu3c4t0r</code>.</p><p>So the flag will be <code>ASIS{574a1ebc69c34903a4631820f292d11fcd41b906}</code></p><h3 id="Echo-sces60107" style=""><a class="anchor hidden-xs" href="#Echo-sces60107" title="Echo-sces60107"><span class="octicon octicon-link"></span></a>Echo (sces60107)</h3><p>You will be given a binary in this challenge. Just try to execute it.</p><pre><code>$ ./Echo 
Missing argument
$ ./Echo blabla
Error opening blabla!
</code></pre><p>Well, you only get some error message. After using some decompile tool I found this.</p><pre><code>  if ( v9 &lt;= 1 )
  {
    fwrite("Missing argument\n", 1uLL, 0x11uLL, stderr);
    exit(1);
  }
  if ( !strncmp(*(const char **)(a2 + 8), "GIVEMEFLAG", 0xAuLL) )
  {
    v46 = (signed int)sub_970(v49);
  }
</code></pre><p>It seems like you should put <code>GIVEMEFLAG</code> in the first argument.</p><pre><code>./Echo GIVEMEFLAG
a
a
wtf
wtf
thisisuseless
thisisuseless
</code></pre><p>Well it just echo what you input. But <code>sub_970</code> seems interesting. I used gdb to catch return value.</p><p>Then I found this function return a string array</p><p><code>&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;,[.,]</code></p><p>Obviously, it is <code>brainfuck</code>. the last part of this brainfuck string is <code>[.,]</code> which will read your input and output to your screen.</p><p>before that there a bunch of <code>[+]&gt;</code> . It will clean the buffer.</p><p>The goal is clear now. we need to what does it put on the buffer before it remove them.</p><p>We can rewrite the brainfuck string to fulfill our requirements</p><p>The new brainfuck string will be<br>
<code>&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[.&gt;]</code></p><p>Now the binary will output the flag <code>flag{_bR41n---,[&gt;.&lt;],+_fxxK__}</code></p><p>According to the note <code>Note: flag{whatyoufound}, submit ASIS{sha1(whatyoufound)}</code></p><p>The true flag is <code>ASIS{7928cc0d0f66530a42d5d3a06f94bdc24f0492ff}</code></p><h3 id="Left-or-Right-sces60107" style=""><a class="anchor hidden-xs" href="#Left-or-Right-sces60107" title="Left-or-Right-sces60107"><span class="octicon octicon-link"></span></a>Left or Right? (sces60107)</h3><p>Just try to execute the given binary.</p><pre><code>$ ./right_or_left 
What's The Secret Key?
I dont know
invalid key:( try again
</code></pre><p>So it seems like we need a secret key?</p><p>Then I levearaged a decompiler to reverse this binary. Unfortunately, I found that it’s a <code>rust</code> binary.</p><p>I am not familar with <code>rust</code>. It’s difficult to me to fully reverse it. Then I found some interesting strings like <code>therustlanguageisfun</code> and <code>superkeymysecretkeygivemetheflagasisctfisfun</code></p><p>I try to input those strings</p><pre><code>$ ./right_or_left 
What's The Secret Key?
therustlanguageisfun
ASIS{that_is_not_the_real_flag}
$ ./right_or_left 
What's The Secret Key?
superkey                                                
ASIS{be_noughty_step_closer_to_see_the_flag}
$ ./right_or_left 
What's The Secret Key?
mysecretkey
ASIS{imagine_a_flag_in_a_watermelon_how_can_you_capture_it}
</code></pre><p>It seems like they are all fake flag.</p><p>Now there is two ways to deal with this chellange. The way I take is finding how this binary output those fake flag.</p><p>Using <code>gdb</code> and <code>IDA pro</code>, I found that those function which will generate fake flag is located at these position.</p><p><img src="https://i.imgur.com/Riza8hO.png" alt=""></p><p>Well, <code>sub_9320</code> seems to be a good target to analysis. Just use <code>gdb</code> and change your $rip. Then, the real flag will output to your screen</p><p>Now you have the flag <code>ASIS{Rust_!s_Right_i5_rust_!5_rust_but_rust_!s_no7_left}</code></p><p>There is another way to capture the flag. In this way, you should find out the real secret key.</p><p>Practically, you need to locate the key-checking function.</p><p>Track those fake key. you will find out the key-checking function. It is located at <code>sub_83c0</code></p><p>Then you can trace this function and easily get the real secret key which is <code>sscsfuntnguageisfunsu</code></p><h3 id="Density-sces60107" style=""><a class="anchor hidden-xs" href="#Density-sces60107" title="Density-sces60107"><span class="octicon octicon-link"></span></a>Density (sces60107)</h3><p>In this challenge you will get a binary and a encrypted flag.</p><p>This chllenge is not difficult at all. The binary name is “b64pack”.</p><p>You can just try base64</p><pre><code>$ base64 short_adff30bd9894908ee5730266025ffd3787042046dd30b61a78e6cc9cadd72191 
O++h+b+qcASIS++e01d+c4Nd+cGoLD+cASIS+c1De4+c4H4t+cg0e5+cf0r+cls+d++gdI++j+kM
+vb++fD9W+q/Cg==
</code></pre><p>There is string while looks like flag<br>
<code>ASIS++e01d+c4Nd+cGoLD+cASIS+c1De4+c4H4t+cg0e5+cf0r+cls+d++gdI++j+kM +vb++fD9W+q/Cg==</code></p><p>We still need to reverse the binary. You can divide this binary into three part.</p><p>The first part:<br>
<code>input=randomstr+input+flag</code></p><p>The second part:</p><pre><code class="python hljs">newinput=<span class="hljs-string">""</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> input:
  <span class="hljs-keyword">if</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">"@$_!\"#%&amp;'()*+,-./:;&lt;=&gt;?\n"</span>:
    newinput+=<span class="hljs-string">"+"</span>+chr(ord(<span class="hljs-string">'a'</span>)+<span class="hljs-string">"@$_!\"#%&amp;'()*+,-./:;&lt;=&gt;?\n"</span>.index(i))
  <span class="hljs-keyword">elif</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">"[\\]^{|}~`\t"</span>:
    newinput+=<span class="hljs-string">"++"</span>+chr(ord(<span class="hljs-string">'a'</span>)+<span class="hljs-string">"@$_!\"#%&amp;'()*+,-./:;&lt;=&gt;?\n"</span>.index(i))
  <span class="hljs-keyword">else</span>:
    newinput+=i
</code></pre><p>The third part:</p><pre><code>output=newinput.decode("base64")
</code></pre><p>Now you know how to reconstruct the flag.<br>
The flag is <code>ASIS{01d_4Nd_GoLD_ASIS_1De4_4H4t_g0e5_f0r_ls!}</code></p><h2 id="pwn" style=""><a class="anchor hidden-xs" href="#pwn" title="pwn"><span class="octicon octicon-link"></span></a>pwn</h2><h2 id="PPC" style=""><a class="anchor hidden-xs" href="#PPC" title="PPC"><span class="octicon octicon-link"></span></a>PPC</h2><h3 id="Neighbour-lwc" style=""><a class="anchor hidden-xs" href="#Neighbour-lwc" title="Neighbour-lwc"><span class="octicon octicon-link"></span></a>Neighbour (lwc)</h3><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 4.534em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.75em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1003.66em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-7" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">O(log N)</script></span></p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span>
<span data-linenumber="33"></span>
<span data-linenumber="34"></span>
<span data-linenumber="35"></span>
<span data-linenumber="36"></span>
<span data-linenumber="37"></span>
<span data-linenumber="38"></span>
<span data-linenumber="39"></span>
<span data-linenumber="40"></span>
<span data-linenumber="41"></span></div><div class="code"><span class="hljs-comment">#!/usr/bin/env python</span>
<span class="hljs-comment"># -*- coding: utf-8 -*-</span>

<span class="hljs-keyword">from</span> sage.all <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">puzzle</span><span class="hljs-params">(s)</span>:</span>
    <span class="hljs-keyword">import</span> string
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> string.printable:
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> string.printable:
            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> string.printable:
                <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> string.printable:
                    <span class="hljs-keyword">if</span> hashlib.sha256(i+j+k+l).hexdigest()[<span class="hljs-number">-6</span>:] == s:
                        <span class="hljs-keyword">return</span> i+j+k+l

r = remote(<span class="hljs-string">'37.139.22.174'</span>, <span class="hljs-number">11740</span>)

r.recvuntil(<span class="hljs-string">'sha256(X)[-6:] = '</span>)
s = r.recv(<span class="hljs-number">6</span>)
r.sendline(puzzle(s))

stage = <span class="hljs-number">1</span>
<span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
    r.recvuntil(<span class="hljs-string">'n = '</span>)
    n = Integer(r.recvline())
    <span class="hljs-keyword">print</span> <span class="hljs-string">'stage %d n = '</span> % stage + str(n)
    stage += <span class="hljs-number">1</span>
    ans = n - max(map(<span class="hljs-keyword">lambda</span> i: power(Integer(floor(n.n(digits=len(str(n))).nth_root(i))), i), range(<span class="hljs-number">2</span>, int(ln(n)/ln(<span class="hljs-number">2</span>))+<span class="hljs-number">1</span>)))

    <span class="hljs-keyword">print</span> ans
    r.sendline(str(ans))
    r.recvuntil(<span class="hljs-string">'To win the flag, submit r :)\n'</span>)
    tmp = r.recvline()
    <span class="hljs-keyword">print</span> tmp
    <span class="hljs-keyword">if</span> <span class="hljs-string">'Great!'</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> tmp:
        <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">if</span> <span class="hljs-string">'next'</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> tmp:
        <span class="hljs-keyword">break</span>


r.interactive()
</div></div></code></pre><h3 id="The-most-Boring-how2hack" style=""><a class="anchor hidden-xs" href="#The-most-Boring-how2hack" title="The-most-Boring-how2hack"><span class="octicon octicon-link"></span></a>The most Boring (how2hack)</h3><p>I used more time to understand the challenge description than solving this challenge ==<br>
Basically it wants us to give 3 different string that all consecutive k characters will not repeat. As I am familiar with pwn, I quickly think of pwntools cyclic() function. Pwntools is the best tool!</p><pre><code class="python hljs"><span class="hljs-comment">#!/usr/bin/env python</span>

<span class="hljs-keyword">import</span> itertools <span class="hljs-keyword">as</span> it
<span class="hljs-keyword">import</span> string
<span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256
<span class="hljs-keyword">import</span> multiprocessing <span class="hljs-keyword">as</span> mp

<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *

host = <span class="hljs-string">'37.139.22.174'</span>
port = <span class="hljs-number">56653</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">check</span><span class="hljs-params">(p)</span>:</span>
    <span class="hljs-keyword">if</span> sha256(p).hexdigest()[<span class="hljs-number">-6</span>:] == target:
        <span class="hljs-keyword">return</span> p
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">None</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">my_remote</span><span class="hljs-params">(ip, port, show=False)</span>:</span>
    <span class="hljs-keyword">global</span> target
    r = remote(ip, port)
    menu = r.recvuntil(<span class="hljs-string">'Submit a printable string X, such that sha256(X)[-6:] = '</span>, drop=<span class="hljs-keyword">True</span>)
    <span class="hljs-keyword">if</span> show:
        print(menu)
    target = r.recvline().strip()
    possible = string.ascii_letters+string.digits
    possible = it.imap(<span class="hljs-string">''</span>.join, it.product(possible, repeat=<span class="hljs-number">4</span>))
    pool = mp.Pool(<span class="hljs-number">32</span>)
    log.info(<span class="hljs-string">'PoW XXXX = %s'</span> % (target))
    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> pool.imap_unordered(check, possible, chunksize=<span class="hljs-number">100000</span>):
        <span class="hljs-keyword">if</span> c:
            log.info(<span class="hljs-string">'Solved - %s'</span> % c)
            r.sendline(c)
            <span class="hljs-keyword">break</span>
    pool.close()
    <span class="hljs-keyword">return</span> r

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">import</span> sys
    r = my_remote(host, port, show=<span class="hljs-keyword">True</span>)

    <span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
        r.recvuntil(<span class="hljs-string">'k = '</span>)
        k = int(r.recvline().strip())
        log.info(<span class="hljs-string">'k = '</span> + str(k))
        r.recvuntil(<span class="hljs-string">'send the first sequence: \n'</span>)
        r.sendline(cyclic(alphabet=<span class="hljs-string">'012'</span>, n=k))
        r.recvuntil(<span class="hljs-string">'send the second sequence: \n'</span>)
        r.sendline(cyclic(alphabet=<span class="hljs-string">'120'</span>, n=k))
        r.recvuntil(<span class="hljs-string">'send the third sequence: \n'</span>)
        r.sendline(cyclic(alphabet=<span class="hljs-string">'201'</span>, n=k))        

        <span class="hljs-keyword">if</span> k == <span class="hljs-number">9</span>:
            <span class="hljs-keyword">break</span>

    r.interactive()
</code></pre><p>Flag: <code>ASIS{67f99742bdf354228572fca52012287c}</code></p><h3 id="Shapiro-shw" style=""><a class="anchor hidden-xs" href="#Shapiro-shw" title="Shapiro-shw"><span class="octicon octicon-link"></span></a>Shapiro (shw)</h3><p>Shapiro points are lattice points that the gcd of its coordinates is 1. In this challenge, we have to construct a <code>k x k</code> grid such that none of its point is a Shapiro point.</p><p>Take <code>k = 3</code> for example, we have to decide <code>x, y</code> such that all of the following points are not Shapiro.</p><pre><code>(x+0, y+2), (x+1, y+2), (x+2, y+2)
(x+0, y+1), (x+1, y+1), (x+2, y+1)
(x+0, y+0), (x+1, y+0), (x+2, y+0)
</code></pre><p>The basic idea is to assign every point a prime as a common divisor of its coordinates. We let the assigned primes be different for all points, e.g.,</p><pre><code>x+0 = y+0 = 0 mod 2
x+0 = y+1 = 0 mod 3
x+0 = y+2 = 0 mod 5
x+1 = y+0 = 0 mod 7
... and so on
</code></pre><p>According to CRT, the congruence equation exists solutions for <code>x, y mod P</code>, where <code>P</code> is the product of all primes we had used.</p><p>Note that there would be restrictions such as <code>the largest y coordinate smaller than k</code>, or <code>the smallest x coordinate larger than k</code>. However, it’s lucky for us that the two restrictions <code>larger</code> and <code>smaller</code> do not occur at the same time. Thus, we can add (or minus) <code>x, y</code> with <code>P</code> to sufficiently large (or small) to satisfy the condition.<br>
Code snippet:</p><pre><code class="python hljs"><span class="hljs-keyword">from</span> gmpy <span class="hljs-keyword">import</span> *

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find</span><span class="hljs-params">(k)</span>:</span>
    p = next_prime(<span class="hljs-number">1</span>)
    mod, rx, ry = [], [], []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(k):
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(k):
            mod.append(p)
            rx.append((p-i)%p)
            ry.append((p-j)%p)
            p = next_prime(p)
    <span class="hljs-keyword">return</span> mod, rx, ry

<span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
    r.recvuntil(<span class="hljs-string">'k = '</span>)
    k = int(r.recvline()[:<span class="hljs-number">-1</span>])

    m, rx, ry = find(k)
    X = chinese_remainder(m, rx)
    Y = chinese_remainder(m, ry)

    cond = r.recvline()[:<span class="hljs-number">-1</span>]
    prod = reduce(<span class="hljs-keyword">lambda</span> x, y: x*y, m)
    <span class="hljs-keyword">if</span> <span class="hljs-string">'larger'</span> <span class="hljs-keyword">in</span> cond:
        lb = int(cond.split()[<span class="hljs-number">-1</span>])
        q = lb/prod
        X += prod*(q+<span class="hljs-number">1</span>)
        Y += prod*(q+<span class="hljs-number">1</span>)
    <span class="hljs-keyword">elif</span> <span class="hljs-string">'smaller'</span> <span class="hljs-keyword">in</span> cond:
        q = X/prod
        X -= prod*(q+<span class="hljs-number">1</span>)
        Y -= prod*(q+<span class="hljs-number">1</span>)

    r.sendline(get_format(X, Y, k))
    data = r.recvline()[:<span class="hljs-number">-1</span>]
    <span class="hljs-keyword">if</span> <span class="hljs-string">'please pass'</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> data:
        <span class="hljs-keyword">break</span>
</code></pre><p>FLAG: <code>ASIS{9273b8834e4972980677627fe23d96ee}</code></p><h2 id="misc" style=""><a class="anchor hidden-xs" href="#misc" title="misc"><span class="octicon octicon-link"></span></a>misc</h2><h3 id="Plastic-sces60107" style=""><a class="anchor hidden-xs" href="#Plastic-sces60107" title="Plastic-sces60107"><span class="octicon octicon-link"></span></a>Plastic (sces60107)</h3><p>There is a png file. Just try <code>zsteg</code></p><pre><code>$ zsteg plastic
meta XML:com.adobe.xmp.. text: "&lt;x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"XMP Core 5.4.0\"&gt;\n   &lt;rdf:RDF xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"&gt;\n      &lt;rdf:Description rdf:about=\"\"\n            xmlns:exif=\"http://ns.adobe.com/exif/1.0/\"\n            xmlns:tiff=\"http://ns.adobe.com/tiff/1.0/\"&gt;\n         &lt;exif:UserComment&gt;\n            &lt;rdf:Alt&gt;\n               &lt;rdf:li xml:lang=\"x-default\"&gt;AAAFWHjabVRfbBRFGJ/ZOeifa+m2hVJaoNf2iohQtndX9ipS29IeVuwVe/1zbfc4&amp;#xA;5/bm7pbu7V5255DjaDISozExaggxSIxC+2KRqBhjCPFBQwgmPggtSnySFx98IP57&amp;#xA;ML4590dEw2w2+33fzHzz+37fbyeW0TWbStIdKCDHuvUvngi7jxPL1kwj7DZjx4hK&amp;#xA;7Vk3ttSUxsOTbmpmGgB85cLHYntFZXtHp7trx2M7H9/1RI+/78DgoWeC4zNhJarG&amp;#xA;U7pp0ym3kdX1tapqZ02TayYY6l4gOXuOf8t5p92qjm17pXZDnVjf0LhxExMYYg62&amp;#xA;jq1nFaySVbHqlc3NW1pat27b3sacrIZtYHWsnrWwVraNbWeucAzbRNcMMqWaumlN&amp;#xA;ps04maIa1Uk4YxGcjukkksZJQ0toKqa8pMk4piQq1sWwupC0zKwRP1jYOGebWUsl&amp;#xA;k+QE7QTlsbZ7j7N7rzQVDE0cGlKCoeLCUAarZFzcJXX3+fd5fL19/j6/S+qWJLnH&amp;#xA;I/XxIXsLrkf2eX0Sj/YCEbLaVY/X1ztXKtbAaRIumcSeKadd2if/Y4aDofEiO6Jj&amp;#xA;1fnk/qdmOV02tTQjycQjPFH/0xx+MDSWpZhXFyrOLPcPyHxfyVkbch4cHgk88Dn0&amp;#xA;QcqtWJYSmzWwLawxKq4qcVPNpolBi0jme6QMjeSxRTVVJ4vVStYmvNIFnCTz3Cxg&amp;#xA;tiP5IseLri4eibsSpsVfg7qK0Yd35HHatnPpGF+ZxjRl/3+uEHzU3HyWJvyRvGZk&amp;#xA;OFJDLR2UyOouarpoLkNccc3ivOg5bmDV0jhWl5rCFlYp12t1QWajh8cuPss2XnyO&amp;#xA;bWLN08FQgAO8c+T5CWdocmqa+yHtJOHEJAI6TtrcD/LCOgd2lhouiqyJbZ4eMw2s&amp;#xA;mpzp2blyhqV5uWzxaOQoJ3RYUwtqwlZuKSLz4As4KjY8xHO8RP1STH5kvHNgqHTk&amp;#xA;KnEmkoUfg2ocyOCXfrLwp/oT28pTasf4mcNcrUsLctkqKDK9Vwr0uPgDWG2h05mR&amp;#xA;AGsr9fRAXoklXIOh0dCiku+V0l4l6stkbCWa7R1RomNeGXPx+5RofNyQlehonyFN&amp;#xA;ECVKU96x9nZlkR+ZPR4VGx9I698al7MRuSi6wyRH4oPlq+B27uSkZZqUQVAJ6kEL&amp;#xA;6AR7gAfIYB5gkAIZkAenwevgDfAWOAPOgrfBOXAevAveAx+AS+Ay+Ah8Aj4Fn4HP&amp;#xA;wVVwDXwBboBvwC3wPfgR3Ae/Qwesg82wDXZBD4xCDFWYgjY8BV+Gr8I34Tl4Hr4P&amp;#xA;V+CH8DK8Aq/Dm/AWvAvvwfvwF/gb/EP4WvhWuC2sCd8Jd4UfhHvCz8Kvwl8IoCrk&amp;#xA;RLWoDjWhVtSButBu1IP60SAKoHl0FNnoFHoJvYbOoLPoHXQBLaNL6Aq6iq6hr9B1&amp;#xA;dAPddFQ4ahwdjh0Ov2O/Y6DUQQGWr4s8+M9wDP0NfUGwlA==&amp;#xA;&lt;/rdf:li&gt;\n            &lt;/rdf:Alt&gt;\n         &lt;/exif:UserComment&gt;\n         &lt;tiff:Orientation&gt;1&lt;/tiff:Orientation&gt;\n      &lt;/rdf:Description&gt;\n   &lt;/rdf:RDF&gt;\n&lt;/x:xmpmeta&gt;\n"
</code></pre><p>You can notice that there is a base64-encoded string<br>
<code>AAAFWHjabVRfbBRFGJ/ZOeifa+m2hVJaoNf2iohQtndX9ipS29IeVuwVe/1zbfc4&amp;#xA;5/bm7pbu7V5255DjaDISozExaggxSIxC+2KRqBhjCPFBQwgmPggtSnySFx98IP57&amp;#xA;ML4590dEw2w2+33fzHzz+37fbyeW0TWbStIdKCDHuvUvngi7jxPL1kwj7DZjx4hK&amp;#xA;7Vk3ttSUxsOTbmpmGgB85cLHYntFZXtHp7trx2M7H9/1RI+/78DgoWeC4zNhJarG&amp;#xA;U7pp0ym3kdX1tapqZ02TayYY6l4gOXuOf8t5p92qjm17pXZDnVjf0LhxExMYYg62&amp;#xA;jq1nFaySVbHqlc3NW1pat27b3sacrIZtYHWsnrWwVraNbWeucAzbRNcMMqWaumlN&amp;#xA;ps04maIa1Uk4YxGcjukkksZJQ0toKqa8pMk4piQq1sWwupC0zKwRP1jYOGebWUsl&amp;#xA;k+QE7QTlsbZ7j7N7rzQVDE0cGlKCoeLCUAarZFzcJXX3+fd5fL19/j6/S+qWJLnH&amp;#xA;I/XxIXsLrkf2eX0Sj/YCEbLaVY/X1ztXKtbAaRIumcSeKadd2if/Y4aDofEiO6Jj&amp;#xA;1fnk/qdmOV02tTQjycQjPFH/0xx+MDSWpZhXFyrOLPcPyHxfyVkbch4cHgk88Dn0&amp;#xA;QcqtWJYSmzWwLawxKq4qcVPNpolBi0jme6QMjeSxRTVVJ4vVStYmvNIFnCTz3Cxg&amp;#xA;tiP5IseLri4eibsSpsVfg7qK0Yd35HHatnPpGF+ZxjRl/3+uEHzU3HyWJvyRvGZk&amp;#xA;OFJDLR2UyOouarpoLkNccc3ivOg5bmDV0jhWl5rCFlYp12t1QWajh8cuPss2XnyO&amp;#xA;bWLN08FQgAO8c+T5CWdocmqa+yHtJOHEJAI6TtrcD/LCOgd2lhouiqyJbZ4eMw2s&amp;#xA;mpzp2blyhqV5uWzxaOQoJ3RYUwtqwlZuKSLz4As4KjY8xHO8RP1STH5kvHNgqHTk&amp;#xA;KnEmkoUfg2ocyOCXfrLwp/oT28pTasf4mcNcrUsLctkqKDK9Vwr0uPgDWG2h05mR&amp;#xA;AGsr9fRAXoklXIOh0dCiku+V0l4l6stkbCWa7R1RomNeGXPx+5RofNyQlehonyFN&amp;#xA;ECVKU96x9nZlkR+ZPR4VGx9I698al7MRuSi6wyRH4oPlq+B27uSkZZqUQVAJ6kEL&amp;#xA;6AR7gAfIYB5gkAIZkAenwevgDfAWOAPOgrfBOXAevAveAx+AS+Ay+Ah8Aj4Fn4HP&amp;#xA;wVVwDXwBboBvwC3wPfgR3Ae/Qwesg82wDXZBD4xCDFWYgjY8BV+Gr8I34Tl4Hr4P&amp;#xA;V+CH8DK8Aq/Dm/AWvAvvwfvwF/gb/EP4WvhWuC2sCd8Jd4UfhHvCz8Kvwl8IoCrk&amp;#xA;RLWoDjWhVtSButBu1IP60SAKoHl0FNnoFHoJvYbOoLPoHXQBLaNL6Aq6iq6hr9B1&amp;#xA;dAPddFQ4ahwdjh0Ov2O/Y6DUQQGWr4s8+M9wDP0NfUGwlA==</code></p><p>But you cannot just use base64 decoder. There is something you need to do first.</p><p>You remove every <code>&amp;#xA;</code> in the string. Then, you can use base64 decode.</p><p>After base64decoding, you still don’t know what it is.<br>
Just use <code>binwalk</code>, then you can find out that there is a zlib compressed data</p><p>The final step is decompress the data. The flag is right here</p><pre><code>$ strings decompressed_data 
bplist00
wxX$versionX$objectsY$archiverT$top
!"#$%&amp;'()*+189=AGHNOWX\_cdhlostU$null
 WNS.keysZNS.objectsV$class
 XbaselineUcolorTmodeUtitleXpreamble]magnificationTdate_
backgroundColorZsourceText#
./0UNSRGB\NSColorSpaceO
*0.9862459898 0.007120999973 0.02743400075
2345Z$classnameX$classesWNSColor
67WNSColorXNSObject
:;&lt;YNS.string
23&gt;?_
NSMutableString
&gt;@7XNSString
CDEFXNSString\NSAttributes
\documentclass[10pt]{article}
\usepackage[usenames]{color} %used for font color
\usepackage{amssymb} %maths
\usepackage{amsmath} %maths
\usepackage[utf8]{inputenc} %useful to type directly diacritic characters
VNSFont
STUVVNSSizeXNSfFlagsVNSName#@(
VMonaco
23YZVNSFont
[7VNSFont
23]^\NSDictionary
23`a_
NSAttributedString
NSAttributedString#@B
fgWNS.time#A
23ijVNSDate
k7VNSDate
m/0F1 1 1
CpEF
={\bf ASIS}\{50m3\_4pps\_u5E\_M37adat4\_dOn7\_I9n0Re\_th3M!!\}
23uv_
NSMutableDictionary
u]7_
NSKeyedArchiver
yzTroot

</code></pre><p>The flag is <code>ASIS{50m3_4pps_u5E_M37adat4_dOn7_I9n0Re_th3M!!}</code></p><h2 id="forensic" style=""><a class="anchor hidden-xs" href="#forensic" title="forensic"><span class="octicon octicon-link"></span></a>forensic</h2><h3 id="Trashy-Or-Classy-sces60107-bookgin" style=""><a class="anchor hidden-xs" href="#Trashy-Or-Classy-sces60107-bookgin" title="Trashy-Or-Classy-sces60107-bookgin"><span class="octicon octicon-link"></span></a>Trashy Or Classy (sces60107 bookgin)</h3><p>In this forensic challenge you will get a pcap file.</p><p>In this pcap file you will notice that someone trying to connet to the website which is located at <code>http://167.99.233.88/</code></p><p>It’s a compilicated challenge. I will try to make a long story short.</p><p>This challenge can be divided into three steps.</p><h4 id="first-step"><a class="anchor hidden-xs" href="#first-step" title="first-step"><span class="octicon octicon-link"></span></a>first step</h4><p>In the first step, you will find an interest file from pcap which is <code>flag.caidx</code></p><p>Just google the extension, you will see a github repo <a href="https://github.com/systemd/casync" target="_blank">casync</a></p><p>You also notice the <code>flag.caidx</code> is located at <code>http://167.99.233.88/private/flag.caidx</code></p><p>There is also a suspicious direcory which is <code>http://167.99.233.88/private/flag.castr</code></p><p>But you need the username and password for the authentication.</p><h4 id="second-step"><a class="anchor hidden-xs" href="#second-step" title="second-step"><span class="octicon octicon-link"></span></a>second step</h4><p>The username can be found in the pcap file. It’s <code>admin</code></p><p>But we still need password. Then, you can find out that the authentication is <a href="https://en.wikipedia.org/wiki/Digest_access_authentication" target="_blank">Digest access authentication</a></p><p>You have everything you need to crack the password now. Just download rockyou.txt and launch a dictionary attack.</p><p>It’s won’t take too much time to crack the password.</p><p>Finally, the password is <code>rainbow</code></p><h4 id="third-step"><a class="anchor hidden-xs" href="#third-step" title="third-step"><span class="octicon octicon-link"></span></a>third step</h4><p>Now you can login and download the <code>flag.caidx</code>.</p><p>But you still cannot list <code>flag.castr</code></p><p>You may need to install <code>casync</code></p><p>Then you can use <code>test-caindex</code></p><pre><code>trashy/casync/build$ ./test-caindex ../../flag.caidx 
caf4408bde20bf1a2d797286b1ad360019daa59b53e55469935c6a8443c69770 (51)
b94307380cddabe9831f56f445f26c0d836b011d3cff27b9814b0cb0524718e5 (58)
4ace69b7c210ddb7e675a0183a88063a5d35dcf26aa5e0050c25dde35e0c2c07 (50)
383bd2a5467300dbcb4ffeaa9503f1b2df0795671995e5ce0a707436c0b47ba0 (50)
...
</code></pre><p>These message will tell you the chunk file’s position.<br>
For example, <code>caf4408bde20bf1a2d797286b1ad360019daa59b53e55469935c6a8443c69770.cacnk</code> is located at <code>flag.castr/caf4/caf4408bde20bf1a2d797286b1ad360019daa59b53e55469935c6a8443c69770.cacnk</code></p><p>You can download all the chunk file in  <code>flag.castr</code> now.</p><p>Now you can extract the flag</p><pre><code>trashy$ sudo casync extract --store=flag.castr flag.caidx wherever_you_like
trashy$ cd wherever_you_like
trashy/wherever_you_like$ ls
flag.png
</code></pre><p>The flaf is right here.<br>
<img src="https://i.imgur.com/SSoTmJm.png" alt=""></p><p>The flag is <code>ASIS{Great!_y0U_CAn_g3T_7h3_casync_To0l,tHe_Content-Addressable_Data_Synchronization_T0Ol!!!}</code></p><h3 id="Tokyo-sces60107" style=""><a class="anchor hidden-xs" href="#Tokyo-sces60107" title="Tokyo-sces60107"><span class="octicon octicon-link"></span></a>Tokyo (sces60107)</h3><p>Without the hint, this challenge is probably the most guessing challenge in this CTF.</p><p>We will get a binary, but it can’t be recognized by any tools.</p><p>After some investigation, I got three clues from the binary.</p><p>First, there is a header at the begining of this binary. And the header begin with <code>KC\n</code></p><p>Second, we found some interesting blocks at the end of the binary. Each block’ size is 24byte. And Each block contains a printable letter.</p><p>Gather all the printable letter. It seems like you can reconstruct the flag from it in some order.</p><p><code>!_Ab_ni!_as__ial_Cb_a_iSgJg_td_eKeyao_ae_spb}iIyafa{S_r__ora3atnsonnoti_faon_imn_armtdrua</code></p><p>Third, this binary contains lots of null byte. However, beside the begining and the end, we can still find some non-null byte in the binary.</p><p>Totally, I found 89 blocks in the binary and each blocks is 3 byte long.<br>
what a coincidence! The length of flag is also 89.</p><p>These blocks are big-endian-encoded. Their values go from 787215 to 787479, increasing 3 by 3.</p><p>That’s all the clue. Unfortunately, no one can solve this challenge. So, the host release the hint <code>Kyoto Cabinet</code></p><p>Now we know this file is <a href="http://fallabs.com/kyotocabinet/" target="_blank">kyoto cabinet</a> database</p><p><code>KC\n</code> is the magic signatrure of kyoto cabinet database file.</p><p>According the header, we can also find out that it is a hashdatabase.</p><p>After understanding the mechanism of kypto cabinet database, the end of the database is the record section.</p><p>Those 3-byte-long blocks is buckets.</p><p><img src="https://i.imgur.com/WcskOZg.png" alt=""></p><p>So, the last question is what the key is.</p><p>According to record section, we will know the key size which is 3 byte long.</p><p>After several attempts, I found out the keys of the flag go from “000” to “088”</p><p>It’s time to reconstruct the flag</p><pre><code class="python hljs"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">import</span> kyotocabinet


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">haha</span><span class="hljs-params">(a)</span>:</span>
  k=a.encode(<span class="hljs-string">"hex"</span>)
  <span class="hljs-keyword">return</span> int(k,<span class="hljs-number">16</span>)
f=open(<span class="hljs-string">"tokyo"</span>).read()
j=f[<span class="hljs-number">0x30</span>:]

temp=[]
flag=<span class="hljs-keyword">False</span>
kk=<span class="hljs-string">""</span>
pos=<span class="hljs-number">0</span>
hh=[]
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(j)):
  <span class="hljs-keyword">if</span> j[i]!=<span class="hljs-string">"\x00"</span>:
    <span class="hljs-keyword">if</span> flag:
      kk+=j[i]
    <span class="hljs-keyword">else</span>:
      kk=j[i]
      flag=<span class="hljs-keyword">True</span>
  <span class="hljs-keyword">else</span>:
    <span class="hljs-keyword">if</span> flag:
      <span class="hljs-keyword">if</span> kk==<span class="hljs-string">"\xcc\x04"</span>:
        pos=i
        <span class="hljs-keyword">break</span>
      temp.append(kk)
      kk=<span class="hljs-string">""</span>
      flag=<span class="hljs-keyword">False</span>
      hh.append(i<span class="hljs-number">-3</span>)


t=j[pos:]
t2=[]
flag=<span class="hljs-keyword">False</span>
kk=<span class="hljs-string">""</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(t)):
  <span class="hljs-keyword">if</span> t[i]!=<span class="hljs-string">"\x00"</span>:
    <span class="hljs-keyword">if</span> flag:
      kk+=t[i]
    <span class="hljs-keyword">else</span>:
      kk=t[i]
      flag=<span class="hljs-keyword">True</span>
  <span class="hljs-keyword">else</span>:
    <span class="hljs-keyword">if</span> flag:
      <span class="hljs-keyword">if</span> len(kk)&lt;<span class="hljs-number">2</span> <span class="hljs-keyword">or</span> kk[<span class="hljs-number">1</span>]!=<span class="hljs-string">"\xee"</span>:
        kk=<span class="hljs-string">""</span>
        <span class="hljs-keyword">continue</span>
      t2.append(kk[<span class="hljs-number">0</span>])
      kk=<span class="hljs-string">""</span>
      flag=<span class="hljs-keyword">False</span>
i=map(haha,temp)



flag = <span class="hljs-string">""</span>.join(t2)
flag2=<span class="hljs-string">""</span>
<span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> map(haha,temp):
  v=sorted(i).index(k)
  flag2+=flag[(v)%<span class="hljs-number">89</span>]
<span class="hljs-keyword">print</span> flag
<span class="hljs-keyword">print</span> flag2

indd=[]
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">89</span>):
  j=str(i).rjust(<span class="hljs-number">3</span>,<span class="hljs-string">"0"</span>)
  temp=kyotocabinet.hash_murmur(j)
  indd.append(temp%<span class="hljs-number">0x100007</span>)


flag3=<span class="hljs-string">""</span>
<span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> indd:
  v=sorted(indd).index(k)
  flag3+=flag2[(v)%<span class="hljs-number">89</span>]
<span class="hljs-keyword">print</span> flag3
</code></pre><p>This code is not a clean code. I’m sorry about that.</p><p>By the way, the flag is <code>ASIS{Kyoto_Cabinet___is___a_library_of_routines_for_managing_a_database_mad3_in_Japan!_!}</code></p><h2 id="crypto" style=""><a class="anchor hidden-xs" href="#crypto" title="crypto"><span class="octicon octicon-link"></span></a>crypto</h2><h3 id="the_early_school-shw" style=""><a class="anchor hidden-xs" href="#the_early_school-shw" title="the_early_school-shw"><span class="octicon octicon-link"></span></a>the_early_school (shw)</h3><pre><code class="python hljs"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dec</span><span class="hljs-params">(s)</span>:</span>
    <span class="hljs-keyword">if</span> len(s) % <span class="hljs-number">3</span> == <span class="hljs-number">2</span>:
        <span class="hljs-keyword">return</span> dec(s[:<span class="hljs-number">-2</span>]) + s[<span class="hljs-number">-2</span>]
    r = <span class="hljs-string">''</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, len(s), <span class="hljs-number">3</span>):
        r += s[i:i+<span class="hljs-number">2</span>]
    <span class="hljs-keyword">return</span> r

<span class="hljs-keyword">with</span> open(<span class="hljs-string">'FLAG.enc'</span>, <span class="hljs-string">'rb'</span>) <span class="hljs-keyword">as</span> f:
    s = f.read()
ENC = bin(bytes_to_long(s))[<span class="hljs-number">2</span>:]

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">30</span>):
    ENC = dec(ENC)
    a = long_to_bytes(int(ENC, <span class="hljs-number">2</span>))
    <span class="hljs-keyword">if</span> <span class="hljs-string">'ASIS'</span> <span class="hljs-keyword">in</span> a:
        <span class="hljs-keyword">print</span> a
        <span class="hljs-keyword">break</span>
</code></pre><p>FLAG: <code>ASIS{50_S1mPl3_CryptO__4__warmup____}</code></p><h3 id="Iran-shw-and-sasdf" style=""><a class="anchor hidden-xs" href="#Iran-shw-and-sasdf" title="Iran-shw-and-sasdf"><span class="octicon octicon-link"></span></a>Iran (shw and sasdf)</h3><h4 id="First-half"><a class="anchor hidden-xs" href="#First-half" title="First-half"><span class="octicon octicon-link"></span></a>First-half</h4><p>We know how the key is generated.</p><pre><code class="python hljs">key_0 = keysaz(gmpy.next_prime(r+s), gmpy.next_prime((r+s)&lt;&lt;<span class="hljs-number">2</span>))
</code></pre><p>Let <code>p = next_prime(r+s)</code> and <code>q = next_prime((r+s)&lt;&lt;2)</code>, we have that <code>4p ≈ q</code> (approximately equal). Thus, <code>N = pq ≈ q^2/4</code> and <code>q ≈ sqrt(4*N)</code>. We can try to brute force <code>q</code> to get the correct <code>(p, q)</code> pair.</p><pre><code class="python hljs"><span class="hljs-keyword">from</span> decimal <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">import</span> gmpy

getcontext().prec = <span class="hljs-number">1000</span>
t = Decimal(<span class="hljs-number">4</span>*N).sqrt()
t = int(t)

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">10000</span>):
    q = t - i <span class="hljs-comment"># or try t + i</span>
    <span class="hljs-keyword">if</span> n % q != <span class="hljs-number">0</span>:
        <span class="hljs-keyword">continue</span>
    p = n / q
    <span class="hljs-keyword">assert</span>(gmpy.is_prime(p) <span class="hljs-keyword">and</span> gmpy.is_prime(q))
    <span class="hljs-keyword">print</span> <span class="hljs-string">'p ='</span>, p
    <span class="hljs-keyword">print</span> <span class="hljs-string">'q ='</span>, q
</code></pre><p>After we get <code>p, q</code>, we can decrypt <code>enc_0</code> to get the first half of flag.</p><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decrypt</span><span class="hljs-params">(a, b, m)</span>:</span>
    n, e = a*b, <span class="hljs-number">65537</span>
    d = gmpy.invert(e, (a<span class="hljs-number">-1</span>)*(b<span class="hljs-number">-1</span>))
    key = RSA.construct((long(n), long(e), long(d)))
    dec = key.decrypt(m)
    <span class="hljs-keyword">return</span> dec

<span class="hljs-keyword">print</span> decrypt(p, q, c) <span class="hljs-comment"># ASIS{0240093faf9ce</span>
</code></pre><p>Also, we can get the range of <code>u = r+s</code> by</p><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">prev_prime</span><span class="hljs-params">(p)</span>:</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">20</span>):
        <span class="hljs-keyword">if</span> gmpy.next_prime(p-i) != p:
            <span class="hljs-keyword">return</span> p-i+<span class="hljs-number">1</span>
        
u_min = max(prev_prime(p), (prev_prime(q)/<span class="hljs-number">4</span>)+<span class="hljs-number">1</span>)
u_max = min(p<span class="hljs-number">-1</span>, q/<span class="hljs-number">4</span>)
</code></pre></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav"><li class=""><a href="#ASIS-CTF-Quals-2018" title="ASIS CTF Quals 2018">ASIS CTF Quals 2018</a><ul class="nav"><li><a href="#Web" title="Web">Web</a><ul class="nav"><li><a href="#Nice-code-unsolved-written-by-bookgin" title="Nice code (unsolved, written by bookgin)">Nice code (unsolved, written by bookgin)</a></li><li><a href="#Bug-Flag-bookgin-sces60107" title="Bug Flag (bookgin, sces60107)">Bug Flag (bookgin, sces60107)</a></li><li><a href="#Good-WAF-solved-by-ysc-written-by-bookgin" title="Good WAF (solved by ysc, written by bookgin)">Good WAF (solved by ysc, written by bookgin)</a></li><li><a href="#Personal-Website-solved-by-sasdf-bookgin-sces60107-written-by-bookgin" title="Personal Website (solved by sasdf, bookgin, sces60107, written by bookgin)">Personal Website (solved by sasdf, bookgin, sces60107, written by bookgin)</a></li><li><a href="#Sharp-eyes-unsolved-written-by-bookgin-special-thanks-to-herrera" title="Sharp eyes (unsolved, written by bookgin, special thanks to @herrera)">Sharp eyes (unsolved, written by bookgin, special thanks to @herrera)</a></li><li><a href="#Gameshop-unsolved" title="Gameshop (unsolved)">Gameshop (unsolved)</a></li></ul></li><li><a href="#rev" title="rev">rev</a><ul class="nav"><li><a href="#Warm-up-sces60107" title="Warm up (sces60107)">Warm up (sces60107)</a></li><li><a href="#baby-C-sces60107" title="baby C (sces60107)">baby C (sces60107)</a></li><li><a href="#Echo-sces60107" title="Echo (sces60107)">Echo (sces60107)</a></li><li><a href="#Left-or-Right-sces60107" title="Left or Right? (sces60107)">Left or Right? (sces60107)</a></li><li><a href="#Density-sces60107" title="Density (sces60107)">Density (sces60107)</a></li></ul></li><li><a href="#pwn" title="pwn">pwn</a></li><li><a href="#PPC" title="PPC">PPC</a><ul class="nav"><li><a href="#Neighbour-lwc" title="Neighbour (lwc)">Neighbour (lwc)</a></li><li><a href="#The-most-Boring-how2hack" title="The most Boring (how2hack)">The most Boring (how2hack)</a></li><li><a href="#Shapiro-shw" title="Shapiro (shw)">Shapiro (shw)</a></li></ul></li><li><a href="#misc" title="misc">misc</a><ul class="nav"><li><a href="#Plastic-sces60107" title="Plastic (sces60107)">Plastic (sces60107)</a></li></ul></li><li><a href="#forensic" title="forensic">forensic</a><ul class="nav"><li><a href="#Trashy-Or-Classy-sces60107-bookgin" title="Trashy Or Classy (sces60107 bookgin)">Trashy Or Classy (sces60107 bookgin)</a></li><li><a href="#Tokyo-sces60107" title="Tokyo (sces60107)">Tokyo (sces60107)</a></li></ul></li><li><a href="#crypto" title="crypto">crypto</a><ul class="nav"><li><a href="#the_early_school-shw" title="the_early_school (shw)">the_early_school (shw)</a></li><li><a href="#Iran-shw-and-sasdf" title="Iran (shw and sasdf)">Iran (shw and sasdf)</a></li></ul></li></ul></li></ul></div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav"><li class=""><a href="#ASIS-CTF-Quals-2018" title="ASIS CTF Quals 2018">ASIS CTF Quals 2018</a><ul class="nav"><li><a href="#Web" title="Web">Web</a><ul class="nav"><li><a href="#Nice-code-unsolved-written-by-bookgin" title="Nice code (unsolved, written by bookgin)">Nice code (unsolved, written by bookgin)</a></li><li><a href="#Bug-Flag-bookgin-sces60107" title="Bug Flag (bookgin, sces60107)">Bug Flag (bookgin, sces60107)</a></li><li><a href="#Good-WAF-solved-by-ysc-written-by-bookgin" title="Good WAF (solved by ysc, written by bookgin)">Good WAF (solved by ysc, written by bookgin)</a></li><li><a href="#Personal-Website-solved-by-sasdf-bookgin-sces60107-written-by-bookgin" title="Personal Website (solved by sasdf, bookgin, sces60107, written by bookgin)">Personal Website (solved by sasdf, bookgin, sces60107, written by bookgin)</a></li><li><a href="#Sharp-eyes-unsolved-written-by-bookgin-special-thanks-to-herrera" title="Sharp eyes (unsolved, written by bookgin, special thanks to @herrera)">Sharp eyes (unsolved, written by bookgin, special thanks to @herrera)</a></li><li><a href="#Gameshop-unsolved" title="Gameshop (unsolved)">Gameshop (unsolved)</a></li></ul></li><li><a href="#rev" title="rev">rev</a><ul class="nav"><li><a href="#Warm-up-sces60107" title="Warm up (sces60107)">Warm up (sces60107)</a></li><li><a href="#baby-C-sces60107" title="baby C (sces60107)">baby C (sces60107)</a></li><li><a href="#Echo-sces60107" title="Echo (sces60107)">Echo (sces60107)</a></li><li><a href="#Left-or-Right-sces60107" title="Left or Right? (sces60107)">Left or Right? (sces60107)</a></li><li><a href="#Density-sces60107" title="Density (sces60107)">Density (sces60107)</a></li></ul></li><li><a href="#pwn" title="pwn">pwn</a></li><li><a href="#PPC" title="PPC">PPC</a><ul class="nav"><li><a href="#Neighbour-lwc" title="Neighbour (lwc)">Neighbour (lwc)</a></li><li><a href="#The-most-Boring-how2hack" title="The most Boring (how2hack)">The most Boring (how2hack)</a></li><li><a href="#Shapiro-shw" title="Shapiro (shw)">Shapiro (shw)</a></li></ul></li><li><a href="#misc" title="misc">misc</a><ul class="nav"><li><a href="#Plastic-sces60107" title="Plastic (sces60107)">Plastic (sces60107)</a></li></ul></li><li><a href="#forensic" title="forensic">forensic</a><ul class="nav"><li><a href="#Trashy-Or-Classy-sces60107-bookgin" title="Trashy Or Classy (sces60107 bookgin)">Trashy Or Classy (sces60107 bookgin)</a></li><li><a href="#Tokyo-sces60107" title="Tokyo (sces60107)">Tokyo (sces60107)</a></li></ul></li><li><a href="#crypto" title="crypto">crypto</a><ul class="nav"><li><a href="#the_early_school-shw" title="the_early_school (shw)">the_early_school (shw)</a></li><li><a href="#Iran-shw-and-sasdf" title="Iran (shw and sasdf)">Iran (shw and sasdf)</a></li></ul></li></ul></li></ul></div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
